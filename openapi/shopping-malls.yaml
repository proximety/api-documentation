openapi: '3.0.2'
info:
  title: Shopping mall service
  version: '1.0'
  license:
    name: Proximety
    url: www.proximety.io
servers:
  - url: https://app-dev.proximety.io/api
  - url: https://app-staging.proximety.io/api
  - url: https://app-patch.proximety.io/api
  - url: https://app.proximety.io/api
  
# - name: User
# - name: Issue Ticket
paths:
  /shopping-malls/users/{userId}:
    get: 
      tags:
        - User management
      summary: Get user details
      parameters:
        - name: userId
          in: path
          required: true 
          example: Mall manager id
          schema:
           type: string
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/MallManager'
              example: {
                        "id": "168f16e0-18b7-4d8c-9c7f-486b901ce52a",
                        "name": {
                            "firstName": "Prince",
                            "middleName": null,
                            "lastName": "Demo",
                            "fullName": "Prince Demo"
                        },
                        "mall": {
                            "id": "3e43b088-6bf3-1014-84f7-005bb96615d0",
                            "name": "HiLite Mall, Kozhikode",
                            "areaCode": "KZD",
                            "mallImageUrl": "https://newprojects.99acres.com/projects/hilite_builders/hilite_mall/images/0j5a9bly_large.jpg"
                        },
                        "email": "testsuperadmin1@proximety.io"
                    }
  /shopping-malls/auth/login:
    post:
      tags:
        - Authentication
      summary: Login admin user
      description: Authenticates and logs in an admin user for a shopping mall.
      operationId: login   
      requestBody:
        description: The details for logging in a user into the admin platform.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        203:
          description: Created
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/LoginResponse'
        400:
          description: Bad request
          content:
            application/json:
              schema:
                  $ref: '#/components/schemas/GlobalException'
              example: 
                {
                  "status": 403,
                  "type": "BAD_REQUEST",
                  "title": "Email / Password incorrect. ",
                  "detail": "The specified Email / Password is incorrect. Please specify a valid Email / Password and try again.",
                  "tags":[]
                }
  # /shopping-malls/auth/logout:
  #   post:
  #     tags:
  #       - Authentication
  #     summary: Log out admin user
  #     description: Logs out an admin user from the admin platform.
  #     operationId: logout   
  #     parameters:
  #       - name: Authorization
  #         in: header
  #         description: The authentication bearer token.
  #         required: true
  #         example: Bearer asd.js2jd9a.gC6paXtNOg0OZL4-adsd-asd
  #         schema:
  #           type: string
  #     requestBody:
  #       description: The details for logging out a user from the admin platform.
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             $ref: '#/components/schemas/LogoutRequest'
  #     responses:
  #       203:
  #         description: OK
  #         content:
  #           application/json:
  #             schema:
  #                 $ref: '#/components/schemas/LogoutResponse'
  #       400:
  #         description: Bad request
  #         content:
  #           application/json:
  #             schema:
  #                 $ref: '#/components/schemas/GlobalException'
  #             example: 
  #               {
  #                 "status": 403,
  #                 "type": "BAD_REQUEST",
  #                 "title": "User not found",
  #                 "detail": "The specified user cannot be found.",
  #                 "tags":[]
  #               }
  /shopping-malls:
    get: 
      tags:
        - Shopping mall
      summary: Search malls
      description: Rethrieves the list of malls tied to the proximety platform.
      operationId: getMalls
      parameters:
        - name: Authorization
          in: header
          description: The authentication bearer token.
          required: true
          example: Bearer asd.js2jd9a.gC6paXtNOg0OZL4-adsd-asd
          schema:
            type: string
        - name: areaCode
          in: query
          required: false 
          example: KZD
          schema:
           type: string
      responses:
        203:
          description: OK
          content:
            application/json:
              schema:
                  type: array
                  items:
                    $ref: '#/components/schemas/ShoppingMallDetails'
  /parking-lots:
    get: 
      tags:
        - Parking
      summary: Get parking slots
      description: Retrieves the details of parking slots for the specified shopping mall.
      responses:
        200:
          description: OK
          content: 
            application/json:
              schema: 
                $ref: '#/components/schemas/ParkingLotDetails'
  /shopping-malls/global-data:
    get: 
      tags:
        - Global data
      summary: Fetch global data
      responses:
        200:
          description: OK
          content: 
            application/json:
              schema: 
                $ref: '#/components/schemas/GlobalData'

components:
  schemas:
    GlobalData: 
      type: object
      description: The various global data associated with the sopping mall app. 
      properties:
        aboutUs: 
          type: string
          description: The html formatted 'About Us' data for the shopping mall app.
          example: This voucher is valid until Six months from the date of issuance, and can be redeemed at any Apparel Group stores in UAE This voucher is non-refundable and cannot be exchanged for cash in part or full and is valid for a single transaction only\r\n
        termsAndConditions:
          type: string
          description: The html formatted terms and conditions associated with using the app.
          example: 1.This voucher is valid until Six months from the date of issuance, and can be redeemed at any Apparel Group stores in UAE\r\n2. This voucher is non-refundable and cannot be exchanged for cash in part or full and is valid for a single transaction only\r\n3. This voucher is not valid during sale or in conjunction with any special promotion\r\n4. Club Apparel points cannot be availed or redeemed while using this voucher\r\n5. Strictly no extension of the expiry date from the date of issue will be allowed
        frequentlyAskedQuestions:
          type: array
          items:
            $ref: '#/components/schemas/FAQ'
    FAQ: 
      type: object
      description: Frequently asked question 
      properties:
        question: 
          type: string
          example: How do I know if my reward has been aquired after a purchase?
        answer: 
          type: string
          example: Amar is assigned to investigate a case of serial killings. When Amar investigates the case, he realizes it is not what it seems to be and following down this path will lead to nothing but war between everyone involved.
    MallManager:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          example: test@xyz.com
        name:
          $ref: '#/components/schemas/PersonName'
    PersonName:
      type: object
      properties:
        firstName:
          type: string
          description: Jack
        middleName:
          type: string
          description: David
        lastName:
          type: string
          description: Brown
        fullName:
          type: string
          description: Jack Brown
        
    ParkingLotDetails:
     type: object
     description: The details of the parking lots for a mall.
     properties:
       parkingLots: 
        type: array
        description: The list of parking lots available in a shopping mall.
        items: 
          $ref: '#/components/schemas/ParkingLotFloor'
     example: {
                "parkingLots": [
                    {
                        "floor": {
                "id": 1,
                "name": "First floor"
            },
                        "zones": [
                            {
                                "zone": "A0",
                                "lots": [
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-1"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-2"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-3"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-4"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-5"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-6"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-7"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-8"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-9"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-10"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-11"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-12"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-13"
                                    }
                                ]
                            },
                            {
                                "zone": "B1",
                                "lots": [
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-1"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-2"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-3"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-4"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-5"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-6"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-7"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-8"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-9"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-10"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-11"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-12"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-13"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "floor": "FIRST_FLOOR",
                        "zones": [
                            {
                                "zone": "A0",
                                "lots": [
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-1"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-2"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-3"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-4"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-5"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-6"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-7"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-8"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-9"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-10"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-11"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-12"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-13"
                                    }
                                ]
                            },
                            {
                                "zone": "B1",
                                "lots": [
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-1"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-2"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-3"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-4"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-5"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-6"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "A1-7"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-8"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-9"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-10"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-11"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-12"
                                    },
                                    {
                                        "lotId": "duhh17321783987189",
                                        "name": "B1-13"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
    ParkingLotFloor:
      type: object
      description: The parking lot details grouped by floor.
      properties:
        floor: 
          type: string
          example: GROUND_FLOOR
          enum:
            - GROUND_FLOOR
            - FIRST_FLOOR
            - SECOND_FLOOR
            - THIRD_FLOOR
            - FOURTH_FLOOR
            - FIFTH_FLOOR
            - SIXTH_FLOOR
            - SEVENTH_FLOOR
            - EIGHTH_FLOOR
            - MINUS_ONE
            - MINUS_TWO
            - DEFAULT
        zones:
          type: array
          description: The list of zones in a floor.
          items:
            $ref: '#/components/schemas/ParkingLotZone'
    ParkingLotZone:
      type: object
      description: The details of a parking lot zone.
      properties:
        zone: 
          type: string
          description: The zone in which the parking lot group is situated.
          example: A0
          
        lots: 
          type: array
          description: TThe list of parking lots in the specified zone.
          items:
            $ref: '#/components/schemas/ParkingLot'
    ParkingLot: 
      type: object
      description: The details of a parking lot.
      properties:
        lotId: 
          type: string
          description: The internal system identifier for the parking lot.
          example: "adasddad.87289791"
        name: 
          type: string
          description: The display name for the parking lot.
          example: A0-1
        becoPointId:
          type: string
    ShoppingMallDetails:
      type: object
      description: The details of a shopping mall.
      properties:
        id: 
          type: string
          description: The internal system identifier for the shopping mall
          example: 936hdhjhjkh8881jhdja==
        name: 
          type: string
          description: The name of the shopping mall
          example: HiLite Mall, Kozhikode
        areaCode:
          type: string
          description: The area code associated with the shopping mall.
          example: KZD
          enum: 
            - KZD
        mallImageUrl:
          type: string
          description: The image url for the mall's branding image.
          example: https://s3.ap-south-1.amazonaws.com/proximety.io/profile-pictures-dev/d5b37874-6c6f-43cf-ad3c-f306cb2d360a.png
    LogoutRequest:
      type: object
      description: The logout request.
      properties:
        userId:
          type: string
          description: The internal system identifier for the user trying to log out of the system.
          example: 3hjhf97829132
    LogoutResponse:
      type: object
      description: The logout response.
      properties:
        message: 
          type: string
          description: The logout message.
          example: Logout successful.
    LoginRequest:
      type: object
      description: The request for logging in an admin user.
      properties:
        email:
          type: string
          description: The registered email id for the user.
          example: abc@xyz.com
        password:
          type: string
          description: The passowrd for the user logging into the platform.
          example: 37816dhk
    LoginResponse:
      type: object
      description: The login response.
      properties:
        userId:
          type: string
          description: The internal system identfier for the user logged into the system.
          example: hdjahdihy83871
        mallId:
          type: string
          description: The internal system identifier for the shopping mall to which the admin user has access token.
          example: djajksd89797
        accessToken:
          type: string
          description: The token generated after authentication which needs to be passed in all subsequent calls to the system.
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ1bV9hY2Nlc3MiLCJleHAiOjE2NjAyODE5
        accessTokenType: 
          type: string
          description: The type of access token used.
          example: Bearer
        userRole: 
          type: string
          description: The user role for the loggged in user. The logged in user can either be a mall manager or a platform admin.
          example: MANAGER
          enum:
            - MANAGER
            - ADMIN
    GlobalException:
      type: object
      description: An exception thrown by the system.
      properties:
        status:
          type: integer
          description: The status code for the error.
          example: 401
        type:
          type: string
          description: The type name for the error being thrown.
          example: UNAUTHORIZED
        title:
          type: string
          description: The error title.
          example: Token expired.
        detail:
          type: string
          description: The details of the error being thrown.
          example: The access token has expired for the user. Please generate a new token and try again.
        tags:
          type: array
          description: The varios tags associated with the error that provides additional information about the error.
          items: 
            type: string
            example: ACCESS_TOKEN_INVALID
